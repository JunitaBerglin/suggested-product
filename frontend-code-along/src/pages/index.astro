---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const productData = await getCollection('products')
const products = productData.map(item => item.data)
---

<Layout>
  <main>
    <h1>Hello World</h1>
    <table>
    {products.map(product => <p>{product.name}</p>)}
    {products.map(product => <p>{product.describtion}</p>)}
    {products.map(product => <p>{product.imageSrc}</p>)}
    {products.map(product => <p>{product.prize}</p>)}
    </table>
  </main>
</Layout>

<script>
  fetch("http://localhost:5015/api/v1/Hello")
    .then(result => result.text())
    .then(text => console.log(
      `%c ${text}`, "color:green;",
      "Looks like the backend is available"))
    .catch(() => console.error("Backend is either down or unavailable"))
</script>